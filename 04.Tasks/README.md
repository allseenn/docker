# Контейнеризация

## Урок 4. Dockerfile и слои

### Задания

1. Повторить то, что было на семинаре
2. ** Самостоятельно на основе голой ОС (alpine, ubuntu, debian) сделать образ MariaDB (создать Dockerfile) и подключиться к контейнеру пхпмайадмином.

### Решение

#### 1. Задача

Создаем *Dockerfile* в папке проекта *nginx* 

```
vim Dockerfile
```

<img src=pics/10.png>

Запускаем в папке проекта сборку образа *gb-nginx*

```
docker build -t gb-nginx .
```
Запускаем контейнер на основе образа *gb-nginx* с пробросам порта 80 контейнера на порт 8081 реальной машины

```
docker run -d -p 8081:80 gb-nginx
```
Проверку работы веб-сервера выполним с помощью утилиты *curl*
```
curl http://localhost:8081
```

<img src=pics/11.png>

Виден ответ веб-сервера с *html* страницей *nginx*

#### 2. Задача

Для реализации проекта создам образ включающий сразу три службы:
- **mariadb**
- **php-fpm**
- **nginx**

На веб-сервере будет расположена система управления БД *phpmyadmin*

В папке проекта *maria* для веб-сервера создадим конфиг, включающий работу через *php-fpm*

```
vim nginx
```

<img src=pics/20.png>

В той же папке создадим конфиг для системы *phpmyadmin*

```
vim config.inc.php
```

<img src=pics/21.png>

Третьим файлом в папке проекта будет *Dockerfile*

```
vim Dockerfile
```

<img src=pics/22.png>


Сборка образа *gb-maria*

```
docker build -t gb-maria .
```

Запуск контейнера на основе образа *gb-maria* c пробросом порта 80 контейнера на порт 8080 хостовой ОС

```
docker run -d -p 8080:80 gb-maria
```

Заходим с помощью браузера, подключившись к хостовому порту 8080

<img src=pics/23.png>

После успешной авторизации создаем таблицу *students* в базе *gb* и заносим данные.

<img src=pics/24.png>
